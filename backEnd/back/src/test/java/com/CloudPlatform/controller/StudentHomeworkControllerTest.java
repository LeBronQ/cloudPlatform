package com.CloudPlatform.controller;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.*;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;
import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.CloudPlatform.entity.StudentHomework;
import com.CloudPlatform.entity.StudentHomeworkDetail;
import com.CloudPlatform.repository.StudentHomeworkDetailRepository;
import com.CloudPlatform.repository.StudentHomeworkRepository;
import com.CloudPlatform.service.StudentHomeworkService;
import org.junit.After;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.MvcResult;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.springframework.web.context.WebApplicationContext;

import javax.transaction.Transactional;
import java.util.Date;
import java.util.List;

import static org.junit.Assert.*;
@RunWith(SpringRunner.class)
@SpringBootTest
public class StudentHomeworkControllerTest<Transactional> {

    @Autowired
    private StudentHomeworkDetailRepository studentHomeworkDetailRepository;

    @Autowired
    private StudentHomeworkRepository studentHomeworkRepository;

    @Autowired
    private WebApplicationContext context;

    @Autowired
    private StudentHomeworkService studentHomeworkService;
    private MockMvc mockMvc;

    @Before
    public void before() throws Exception {
        mockMvc = MockMvcBuilders.webAppContextSetup(context).build();
        Date date = new Date(0);
        String correct = "{\"lines\":[{\"points\":[{\"x\":63.81317746638893,\"y\":340.1423517854491},{\"x\":63.81317746638893,\"y\":340.1423517854491},{\"x\":65.01317751407689,\"y\":340.1423503327147},{\"x\":71.08781441426821,\"y\":342.78349586096414},{\"x\":77.03050057312406,\"y\":343.96661815005507},{\"x\":85.01335358779225,\"y\":344.1245475107069},{\"x\":95.02821376510963,\"y\":345.9785226204864},{\"x\":109.04645000333836,\"y\":349.8998963187775},{\"x\":121.026542375461,\"y\":351.9878237425648},{\"x\":136.02134166555223,\"y\":354.02139958876944},{\"x\":146.01323299956672,\"y\":354.1323557051717},{\"x\":156.01701649046416,\"y\":355.05931058002744},{\"x\":162.0132427536615,\"y\":355.13151286950085},{\"x\":175.0484568237635,\"y\":358.8928334599702},{\"x\":179.01435902263174,\"y\":359.09624805683313},{\"x\":186.01319284263573,\"y\":359.13709651326474},{\"x\":191.0259633487298,\"y\":359.9911836908747},{\"x\":197.01339422166464,\"y\":360.122600149853},{\"x\":204.01318032645906,\"y\":360.140099291822},{\"x\":211.01317755057724,\"y\":360.14209291951863},{\"x\":224.01317751422926,\"y\":360.1423326466694},{\"x\":232.0131775140778,\"y\":360.1423475648669},{\"x\":245.01317751407623,\"y\":360.14234913449735},{\"x\":257.01317751407623,\"y\":360.1423492355827},{\"x\":274.01317751407623,\"y\":360.14234924278287},{\"x\":292.01317751407623,\"y\":360.14234924314593},{\"x\":311.01317751407623,\"y\":360.14234924316327},{\"x\":345.01317751407623,\"y\":360.14234924316406},{\"x\":356.01317751407623,\"y\":360.14234924316406},{\"x\":368.01317751407623,\"y\":360.14234924316406},{\"x\":382.01317751407623,\"y\":360.14234924316406},{\"x\":397.01317751407623,\"y\":360.14234924316406},{\"x\":409.01317751407623,\"y\":360.14234924316406},{\"x\":426.01317751407623,\"y\":360.14234924316406},{\"x\":437.01317751407623,\"y\":360.14234924316406},{\"x\":454.01317751407623,\"y\":360.14234924316406},{\"x\":470.01317751407623,\"y\":360.14234924316406},{\"x\":487.01317751407623,\"y\":360.14234924316406},{\"x\":501.01317751407623,\"y\":360.14234924316406},{\"x\":518.0131775140762,\"y\":360.14234924316406},{\"x\":530.0131775140762,\"y\":360.14234924316406},{\"x\":541.0131775140762,\"y\":360.14234924316406},{\"x\":551.0131775140762,\"y\":360.14234924316406},{\"x\":561.0131775140762,\"y\":360.14234924316406},{\"x\":572.0131775140762,\"y\":360.14234924316406},{\"x\":582.0131775140762,\"y\":360.14234924316406},{\"x\":590.0131775140762,\"y\":360.14234924316406},{\"x\":599.0131775140762,\"y\":360.14234924316406},{\"x\":609.0131775140762,\"y\":360.14234924316406},{\"x\":617.0131775140762,\"y\":360.14234924316406},{\"x\":624.0131775140762,\"y\":360.14234924316406},{\"x\":637.0131775140762,\"y\":360.14234924316406},{\"x\":641.0131775140762,\"y\":360.14234924316406},{\"x\":651.0131775140762,\"y\":360.14234924316406},{\"x\":658.0131775140762,\"y\":360.14234924316406},{\"x\":668.0131775140762,\"y\":360.14234924316406},{\"x\":680.0131775140762,\"y\":360.14234924316406},{\"x\":689.0131775140762,\"y\":360.14234924316406},{\"x\":699.0131775140762,\"y\":360.14234924316406},{\"x\":709.0131775140762,\"y\":360.14234924316406},{\"x\":718.0131775140762,\"y\":360.14234924316406},{\"x\":728.0131775140762,\"y\":360.14234924316406},{\"x\":736.0131775140762,\"y\":360.14234924316406},{\"x\":739.0131775140762,\"y\":360.14234924316406},{\"x\":742.0131775140762,\"y\":360.14234924316406},{\"x\":744.0131775140762,\"y\":360.14234924316406},{\"x\":745.0131775140762,\"y\":360.14234924316406},{\"x\":747.0131775140762,\"y\":360.14234924316406},{\"x\":748.0131775140762,\"y\":360.14234924316406},{\"x\":751.0131775140762,\"y\":360.14234924316406},{\"x\":756.0131775140762,\"y\":360.14234924316406},{\"x\":762.0131775140762,\"y\":360.14234924316406},{\"x\":777.0202140942455,\"y\":358.25467168307955},{\"x\":791.0220957279953,\"y\":356.26873456703345},{\"x\":810.0131956807677,\"y\":356.1480676095066},{\"x\":829.0131775512341,\"y\":356.14260786296626},{\"x\":844.0131775141953,\"y\":356.14236388202045},{\"x\":854.013177514077,\"y\":356.14235045187695},{\"x\":866.0131775140762,\"y\":356.14234932749287},{\"x\":871.0131775140762,\"y\":356.1423492560278},{\"x\":874.0131775140762,\"y\":356.1423492461326},{\"x\":879.0131775140762,\"y\":356.1423492436169},{\"x\":880.0131775140762,\"y\":356.14234924337853},{\"x\":880.3111092566066,\"y\":355.8113139650598},{\"x\":880.8624696028912,\"y\":346.0409195894619},{\"x\":880.9085670771143,\"y\":337.042337410406},{\"x\":880.9127968135526,\"y\":327.042349138814},{\"x\":880.9131544963413,\"y\":313.0423492190285},{\"x\":880.9131763341169,\"y\":296.04234921932147},{\"x\":880.9131774204018,\"y\":282.0423492193222},{\"x\":880.9131774865155,\"y\":266.0423492193222},{\"x\":880.9131774900363,\"y\":250.0423492193222},{\"x\":880.9131774902244,\"y\":233.0423492193222},{\"x\":880.9131774902337,\"y\":221.0423492193222},{\"x\":880.9131774902344,\"y\":206.0423492193222},{\"x\":879.0510650088275,\"y\":194.03172373644622},{\"x\":877.9703082377029,\"y\":177.04053409873575},{\"x\":876.0219376560314,\"y\":161.0357535096753},{\"x\":875.9186477929817,\"y\":144.0423325946059},{\"x\":873.0622046029779,\"y\":127.02992508598089},{\"x\":870.0692188616724,\"y\":110.0287188317017},{\"x\":867.9908583969186,\"y\":86.03899055038863},{\"x\":863.0930304274581,\"y\":62.0241955325233},{\"x\":860.0426053211138,\"y\":41.03299417447985},{\"x\":858.008981118338,\"y\":22.037235616915964},{\"x\":857.9179957397371,\"y\":5.042336321713744},{\"x\":857.9133954011452,\"y\":-13.957650807058446}],\"brushColor\":\"red\",\"brushRadius\":43},{\"points\":[{\"x\":65.9499670563273,\"y\":39.2431015103833},{\"x\":65.9499670563273,\"y\":39.2431015103833},{\"x\":65.93060775901907,\"y\":40.24251806854587},{\"x\":67.26336659493145,\"y\":41.51965689743442},{\"x\":70.27441277777339,\"y\":44.50833063208132},{\"x\":72.03808278480687,\"y\":44.93208937153513},{\"x\":76.03969151538504,\"y\":45.925503194488556},{\"x\":81.01379025933568,\"y\":46.10914433417395},{\"x\":90.07969795477634,\"y\":49.80277330017441},{\"x\":107.01334062989406,\"y\":50.12521501258504},{\"x\":126.01317784768884,\"y\":50.141574322168246},{\"x\":147.01317751463966,\"y\":50.142317397096086},{\"x\":171.01317751407697,\"y\":50.14234809210139},{\"x\":192.01317751407623,\"y\":50.14234919586012},{\"x\":211.01317751407623,\"y\":50.14234924102469},{\"x\":222.01317751407623,\"y\":50.14234924300226},{\"x\":230.01317751407623,\"y\":50.1423492431477},{\"x\":232.01317751407623,\"y\":50.14234924315898},{\"x\":234.01317751407623,\"y\":50.142349243162485},{\"x\":236.01317751407623,\"y\":50.14234924316357},{\"x\":241.01317751407623,\"y\":50.142349243163984},{\"x\":248.01317751407623,\"y\":50.142349243164055},{\"x\":265.01317751407623,\"y\":50.14234924316406},{\"x\":286.01411431170925,\"y\":49.18340235638342},{\"x\":310.0310745972162,\"y\":44.3209393974661},{\"x\":331.01320748690415,\"y\":44.14969432249888},{\"x\":355.01391310895633,\"y\":43.17872959018377},{\"x\":385.0151256628314,\"y\":41.201534312082295},{\"x\":408.01650003825506,\"y\":39.2196118097568},{\"x\":434.0131812272973,\"y\":39.144934544687736},{\"x\":452.0131775224962,\"y\":39.14247235278036},{\"x\":465.01317751411153,\"y\":39.14235721429011},{\"x\":481.05015635831785,\"y\":34.397681346414316},{\"x\":491.013426023117,\"y\":34.16349763565191},{\"x\":504.0131785557996,\"y\":34.14371858640369},{\"x\":512.0131775247289,\"y\":34.14248771608721},{\"x\":522.0131775141489,\"y\":34.14236067670791},{\"x\":549.0131775140763,\"y\":34.142349611988045},{\"x\":565.0131775140762,\"y\":34.142349262805574},{\"x\":579.0131775140762,\"y\":34.14234924435046},{\"x\":594.0131775140762,\"y\":34.142349243231216},{\"x\":606.0131775140762,\"y\":34.142349243168745},{\"x\":618.0131775140762,\"y\":34.14234924316439},{\"x\":632.015197627907,\"y\":35.08208213821346},{\"x\":645.0342334936161,\"y\":37.948810079444584},{\"x\":656.0132969426102,\"y\":38.127687828085065},{\"x\":671.0150045330669,\"y\":39.08503174062211},{\"x\":688.0354473383562,\"y\":42.94337754274265},{\"x\":702.0132579895454,\"y\":43.130313905013246},{\"x\":717.0131777719096,\"y\":43.141667994372504},{\"x\":736.0131775146036,\"y\":43.142318432917605},{\"x\":747.0131775140793,\"y\":43.14234691297741},{\"x\":755.0131775140762,\"y\":43.142349007527216},{\"x\":761.0131775140762,\"y\":43.14234921242882},{\"x\":767.0131775140762,\"y\":43.142349239155116},{\"x\":771.0313538610053,\"y\":43.96238523560182},{\"x\":775.0137884241364,\"y\":44.10919407964616},{\"x\":780.026669545415,\"y\":44.98709583464533},{\"x\":785.0134903760766,\"y\":45.118620490500724},{\"x\":787.013207646789,\"y\":45.134984599677075},{\"x\":791.0131785306254,\"y\":45.14099654678267},{\"x\":801.0131775210067,\"y\":45.14223755263031},{\"x\":810.0131775141335,\"y\":45.142339089479414},{\"x\":815.0131775140776,\"y\":45.142347694296944},{\"x\":822.0131775140762,\"y\":45.14234906671085},{\"x\":829.0131775140762,\"y\":45.1423492230618},{\"x\":837.0131775140762,\"y\":45.14234924113125},{\"x\":851.0131775140762,\"y\":45.142349243041274},{\"x\":868.0131775140762,\"y\":45.14234924315789},{\"x\":882.0131775140762,\"y\":45.142349243163686},{\"x\":886.0131775140762,\"y\":45.14234924316399},{\"x\":887.0131775140762,\"y\":45.14234924316403},{\"x\":887.0131775140762,\"y\":45.14234924316403}],\"brushColor\":\"red\",\"brushRadius\":43},{\"points\":[{\"x\":60.46960830170701,\"y\":65.84972800247802},{\"x\":60.46960830170701,\"y\":65.84972800247802},{\"x\":59.418689648767895,\"y\":67.39773027036023},{\"x\":58.99207037912427,\"y\":72.24581376189896},{\"x\":58.92521799163632,\"y\":77.24242981154218},{\"x\":58.91454920528566,\"y\":84.2423503123411},{\"x\":58.913333761583985,\"y\":91.242349280573},{\"x\":57.99541373326127,\"y\":101.24611425309868},{\"x\":57.92149667861524,\"y\":109.24238771721457},{\"x\":57.91386439790335,\"y\":119.2423495291405},{\"x\":57.91326708688775,\"y\":125.24234927146567},{\"x\":57.913182561742936,\"y\":140.24234926702022},{\"x\":57.913178003083544,\"y\":148.24234926700606},{\"x\":57.91317754866022,\"y\":155.24234926700592},{\"x\":57.91317749914679,\"y\":160.24234926700592},{\"x\":57.91317749159389,\"y\":165.24234926700592},{\"x\":57.913177490411705,\"y\":171.24234926700592},{\"x\":57.9131774902575,\"y\":177.24234926700592},{\"x\":57.913177490237395,\"y\":183.24234926700592},{\"x\":57.91317749023458,\"y\":195.24234926700592},{\"x\":56.07560352000105,\"y\":205.25712738287203},{\"x\":52.171611687459276,\"y\":218.28025196165265},{\"x\":50.98911241803582,\"y\":232.24555838470016},{\"x\":48.01933032810862,\"y\":257.24863142858504},{\"x\":43.126837868395356,\"y\":277.2680785757568},{\"x\":42.09527706309138,\"y\":282.26096413854185},{\"x\":41.93698552528693,\"y\":288.2426642235313},{\"x\":41.91867199339557,\"y\":291.2423660391432},{\"x\":41.09409105415445,\"y\":295.26071993360455},{\"x\":40.95507887514576,\"y\":298.24332519953276},{\"x\":40.926184387175574,\"y\":300.2424432604544},{\"x\":40.917214203582056,\"y\":302.2423583198598},{\"x\":40.333674130354744,\"y\":303.3466215681821},{\"x\":38.26001617731499,\"y\":308.3118657200109},{\"x\":37.446558893164315,\"y\":309.4174325334014},{\"x\":37.08606457964834,\"y\":311.2591108770371},{\"x\":36.388969157305894,\"y\":312.3783975126012},{\"x\":36.147558513734104,\"y\":313.2734041971986},{\"x\":35.409180991989004,\"y\":314.3913629028543},{\"x\":35.409180991989004,\"y\":314.3913629028543}],\"brushColor\":\"red\",\"brushRadius\":43},{\"points\":[{\"x\":148.8063495727419,\"y\":162.03169849479883},{\"x\":148.8063495727419,\"y\":162.03169849479883},{\"x\":147.68945171146163,\"y\":162.68693921852397},{\"x\":147.33673048419396,\"y\":163.3482442007468},{\"x\":147.04806575803764,\"y\":165.25251492583658},{\"x\":146.9551409359506,\"y\":167.24332809418686},{\"x\":147.50780176128956,\"y\":168.33881301158075},{\"x\":152.0229599197193,\"y\":169.0100139333223},{\"x\":156.013506872797,\"y\":169.118003048297},{\"x\":160.01318862455764,\"y\":169.13787724779687},{\"x\":169.01769369703246,\"y\":168.23239774785662},{\"x\":181.01319945598226,\"y\":168.14863374381096},{\"x\":189.06050827638782,\"y\":165.43036863286372},{\"x\":199.01349429096126,\"y\":165.16622596886828},{\"x\":206.0206430069746,\"y\":164.25803050040514},{\"x\":215.0547471171906,\"y\":161.41271427736888},{\"x\":216.02255298778766,\"y\":161.27191757543},{\"x\":219.0136761809749,\"y\":161.17230507273294},{\"x\":219.0136761809749,\"y\":161.17230507273294}],\"brushColor\":\"red\",\"brushRadius\":5},{\"points\":[{\"x\":139.64955361886663,\"y\":184.28182474523868},{\"x\":139.64955361886663,\"y\":184.28182474523868},{\"x\":140.16928881176108,\"y\":184.6357630302408},{\"x\":142.02813482682313,\"y\":184.97894960722022},{\"x\":144.01461752869346,\"y\":185.09145766625548},{\"x\":145.01350067714256,\"y\":185.11823308531083},{\"x\":147.0132086389083,\"y\":185.13486434319742},{\"x\":149.01318051182798,\"y\":185.14002632602288},{\"x\":155.01317756507763,\"y\":185.14204625386424},{\"x\":162.01317751473817,\"y\":185.14231472539635},{\"x\":172.01694107288148,\"y\":184.22456992970416},{\"x\":186.01319122326208,\"y\":184.14731677232203},{\"x\":200.0131775640937,\"y\":184.14264929551277},{\"x\":215.01317751423647,\"y\":184.1423662272589},{\"x\":222.0131775140783,\"y\":184.1423511780609},{\"x\":229.01317751407626,\"y\":184.14234946359534},{\"x\":231.01317751407623,\"y\":184.14234931157375},{\"x\":236.01317751407623,\"y\":184.14234925359943},{\"x\":237.01317751407623,\"y\":184.14234924810714},{\"x\":237.01317751407623,\"y\":184.14234924810714}],\"brushColor\":\"red\",\"brushRadius\":5},{\"points\":[{\"x\":337.7964318981234,\"y\":172.31515435891387},{\"x\":337.7964318981234,\"y\":172.31515435891387},{\"x\":339.0161616881952,\"y\":172.21557907299268},{\"x\":347.013207998484,\"y\":172.1497567395874},{\"x\":354.01317790971996,\"y\":172.14319313802727},{\"x\":361.0131775192112,\"y\":172.1424453830872},{\"x\":365.0131775142495,\"y\":172.14236690151694},{\"x\":372.0131775140785,\"y\":172.1423512548751},{\"x\":384.01317751407623,\"y\":172.142349383516},{\"x\":410.01317751407623,\"y\":172.14234924785984},{\"x\":425.0149522436199,\"y\":173.0858570894695},{\"x\":441.01976914306016,\"y\":175.03362260298763},{\"x\":451.01780319471726,\"y\":176.05121841406716},{\"x\":459.0630440670106,\"y\":178.84692900045465},{\"x\":467.022666575308,\"y\":180.0120025229076},{\"x\":471.01349701560645,\"y\":180.11837007182868},{\"x\":472.01324920560336,\"y\":180.13098968306176},{\"x\":472.01324920560336,\"y\":180.13098968306176}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":329.13403029587516,\"y\":185.69187215539287},{\"x\":329.13403029587516,\"y\":185.69187215539287},{\"x\":330.04070978586714,\"y\":185.92144188266917},{\"x\":331.01937619572703,\"y\":186.03690161150877},{\"x\":335.01338636783964,\"y\":186.12296127926217},{\"x\":338.01318863616007,\"y\":186.13787491341992},{\"x\":341.0131781063757,\"y\":186.14131670328675},{\"x\":352.01317751746416,\"y\":186.14227115191116},{\"x\":365.01317751409044,\"y\":186.14234418689603},{\"x\":411.01317751407623,\"y\":186.14234914613547},{\"x\":432.01317751407623,\"y\":186.14234923917658},{\"x\":456.01317751407623,\"y\":186.14234924301994},{\"x\":472.01317751407623,\"y\":186.1423492431564},{\"x\":487.01317751407623,\"y\":186.14234924316364},{\"x\":492.01317751407623,\"y\":186.142349243164},{\"x\":494.01317751407623,\"y\":186.14234924316403},{\"x\":494.01317751407623,\"y\":186.14234924316403}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":590.0493037066256,\"y\":149.2527034651739},{\"x\":590.0493037066256,\"y\":149.2527034651739},{\"x\":589.9446555836961,\"y\":152.24289991901253},{\"x\":591.6283069857335,\"y\":157.2886228509575},{\"x\":594.4087444943913,\"y\":161.39699878211275},{\"x\":595.5777166016057,\"y\":164.3072049746181},{\"x\":599.2390751131039,\"y\":167.54603896970593},{\"x\":600.2618279262301,\"y\":168.52126655739983},{\"x\":607.1427818858742,\"y\":172.67706377179493},{\"x\":609.1176028465746,\"y\":173.7215631413851},{\"x\":611.0232026240454,\"y\":174.00839143399799},{\"x\":617.0133475693856,\"y\":174.12485436877628},{\"x\":618.0132156713285,\"y\":174.1340618071137},{\"x\":624.0131781632472,\"y\":174.14126826807123},{\"x\":630.087767197486,\"y\":171.50109400718105},{\"x\":642.1861565218129,\"y\":162.67285887414187},{\"x\":651.236526550196,\"y\":154.73576601275334},{\"x\":660.1694191128068,\"y\":148.64912674176773},{\"x\":668.2303147731735,\"y\":141.72860726377692},{\"x\":672.3349994239577,\"y\":136.83206663511612},{\"x\":674.2903956662095,\"y\":134.79207438254915},{\"x\":674.7072560602395,\"y\":133.01847498856452},{\"x\":674.8149842124168,\"y\":132.03697656069696},{\"x\":674.8149842124168,\"y\":132.03697656069696}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":709.2150630914297,\"y\":169.71036002058491},{\"x\":709.2150630914297,\"y\":169.71036002058491},{\"x\":714.2109681928871,\"y\":165.70528979047225},{\"x\":718.0195586156391,\"y\":165.24933178403765},{\"x\":724.0524820020539,\"y\":163.40541431821308},{\"x\":726.0898571238349,\"y\":162.5058647605172},{\"x\":729.0172181030126,\"y\":162.2275357064894},{\"x\":732.0461823710128,\"y\":161.38384338456456},{\"x\":736.0142833809579,\"y\":161.18695123182692},{\"x\":737.1246200607414,\"y\":160.57614313140618},{\"x\":738.0385352886066,\"y\":160.35448357847156},{\"x\":740.1999203853707,\"y\":158.69122469301226},{\"x\":746.1175135893318,\"y\":155.56296654414572},{\"x\":751.082701472883,\"y\":153.48920590187024},{\"x\":761.1061652379595,\"y\":148.5407600635029},{\"x\":770.1247378462662,\"y\":143.57635717500844},{\"x\":776.1100846685832,\"y\":140.54860270702267},{\"x\":782.2085693271719,\"y\":135.70228432299956},{\"x\":786.2669223724813,\"y\":131.76873113934454},{\"x\":790.3401033855727,\"y\":126.83631323909673},{\"x\":792.1614567167342,\"y\":125.63723896398362},{\"x\":792.1614567167342,\"y\":125.63723896398362}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":550.9605746934046,\"y\":254.24359818629887},{\"x\":550.9605746934046,\"y\":254.24359818629887},{\"x\":550.9241180014924,\"y\":257.2424157665681},{\"x\":556.1589838859852,\"y\":260.65123625779887},{\"x\":562.1637344841587,\"y\":264.6440168864694},{\"x\":567.0422656712522,\"y\":265.91538545609285},{\"x\":575.0673994988522,\"y\":268.83468132742036},{\"x\":584.036924093456,\"y\":270.9369716842168},{\"x\":591.0465106556417,\"y\":272.8996796016723},{\"x\":594.0149447286029,\"y\":273.08597670537745},{\"x\":596.1791687508762,\"y\":274.62155069513375},{\"x\":601.0168669369218,\"y\":275.060940711024},{\"x\":604.0133738966992,\"y\":275.12354897332887},{\"x\":607.0131879720519,\"y\":275.13801055138515},{\"x\":612.013177757424,\"y\":275.1416874078456},{\"x\":615.0131775270356,\"y\":275.1421965119325},{\"x\":620.0131775143777,\"y\":275.14232594518006},{\"x\":628.0350754490039,\"y\":273.3396732464469},{\"x\":640.1275475387519,\"y\":266.58142274090466},{\"x\":650.0557117444994,\"y\":263.4157581895717},{\"x\":661.0908352768554,\"y\":258.508072145345},{\"x\":665.1751564884714,\"y\":255.65744628066432},{\"x\":665.1751564884714,\"y\":255.65744628066432}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":324.099008704239,\"y\":215.52592341460348},{\"x\":324.099008704239,\"y\":215.52592341460348},{\"x\":326.1055121685007,\"y\":214.53943447979913},{\"x\":327.03413619565475,\"y\":214.3354460051993},{\"x\":330.01429054558326,\"y\":214.1870953918298},{\"x\":336.01319644413957,\"y\":214.14818651604708},{\"x\":345.01317767052194,\"y\":214.1428799052449},{\"x\":364.0131775143962,\"y\":214.14237324295624},{\"x\":385.0131775140768,\"y\":214.14235022945687},{\"x\":417.01317751407623,\"y\":214.1423492701447},{\"x\":456.01317751407623,\"y\":214.14234924377266},{\"x\":504.01317751407623,\"y\":214.14234924317526},{\"x\":542.0131775140762,\"y\":214.14234924316432},{\"x\":569.0131775140762,\"y\":214.14234924316406},{\"x\":582.0131775140762,\"y\":214.14234924316406},{\"x\":582.0131775140762,\"y\":214.14234924316406}],\"brushColor\":\"red\",\"brushRadius\":1}],\"width\":900,\"height\":400}";
        StudentHomework studentHomework = new StudentHomework(1,1, "student", "数学第一次迭代",
                date, date, 99, date, "student", "一年级上数学");
        StudentHomeworkDetail studentHomeworkDetail = new StudentHomeworkDetail("1","1","student","第一次迭代做完了",correct,"做得很好",null,"/homework/student/1605603006322WechatIMG859.jpeg");
        studentHomeworkRepository.save(studentHomework);
        studentHomeworkDetailRepository.save(studentHomeworkDetail);
    }

    @After
    public void after() throws Exception {
    }

    @Test
    public void getMistakenHomework() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/getMistakenHomework")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("studentId", "student")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        JSONArray jsonArray = JSONArray.parseArray(result);

        for (int i = 0 ; i < jsonArray.size(); ++i) {
            JSONObject jsonObject = jsonArray.getJSONObject(i);
            assertNotNull(jsonObject);
        }
    }

    @Test
    public void getStudentHomeworkAll() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/getStudentHomeworkAll")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("studentId", "student")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        JSONArray jsonArray = JSONArray.parseArray(result);
        System.out.println(jsonArray.getJSONObject(0));
        assertNotNull(jsonArray);

    }

    @Test
    public void autoGrading() {
    }

    @Test
    public void getStudentHomeworkAllOfCourse() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/getStudentHomeworkAllOfCourse")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("studentId", "student")
                .param("courseId", "1")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        JSONArray jsonArray = JSONArray.parseArray(result);
        System.out.println(jsonArray.getJSONObject(0));
        for (int i = 0 ; i < jsonArray.size(); ++i){
            JSONObject jsonObject = jsonArray.getJSONObject(i);
            assertNotNull(jsonObject);
        }

    }

    @Test
    public void getStudentHomeworkOne() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/getStudentHomeworkOne")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("studentId", "student")
                .param("homeworkId", "1")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        JSONObject jsonObject = JSONObject.parseObject(result);
        Assert.assertNotNull(jsonObject);
    }

    @Test
    public void upload() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/upload")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("userId", "student")
                .param("file", "WechatIMG859.jpeg")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        JSONArray jsonArray = JSONArray.parseArray(result);
        System.out.println(jsonArray.getJSONObject(0));
        assertNotNull(jsonArray);
    }

    @Test
    public void correctHomework() throws Exception {
        JSONObject jsonObject = new JSONObject();
        jsonObject.put("homeworkId","1");
        jsonObject.put("courseId","1");
        jsonObject.put("studentId","student");
        jsonObject.put("title","数学第二次迭代");
        jsonObject.put("startTime","1970-10-10 11:11:11");
        jsonObject.put("endTime","1970-10-10 11:11:11");
        jsonObject.put("score","100");
        jsonObject.put("nickname","student");
        jsonObject.put("subject","一年级上数学");
        jsonObject.put("content","第一次迭代");
        jsonObject.put("comment","做得很好");
        jsonObject.put("remarks","第一次迭代做完了");
        jsonObject.put("finishHomework","1");
        jsonObject.put("handinRank","1");
        jsonObject.put("upload","/homework/student/1605603006322WechatIMG859.jpeg");
        jsonObject.put("ocontent",null);
        String correct = "{\"lines\":[{\"points\":[{\"x\":63.81317746638893,\"y\":340.1423517854491},{\"x\":63.81317746638893,\"y\":340.1423517854491},{\"x\":65.01317751407689,\"y\":340.1423503327147},{\"x\":71.08781441426821,\"y\":342.78349586096414},{\"x\":77.03050057312406,\"y\":343.96661815005507},{\"x\":85.01335358779225,\"y\":344.1245475107069},{\"x\":95.02821376510963,\"y\":345.9785226204864},{\"x\":109.04645000333836,\"y\":349.8998963187775},{\"x\":121.026542375461,\"y\":351.9878237425648},{\"x\":136.02134166555223,\"y\":354.02139958876944},{\"x\":146.01323299956672,\"y\":354.1323557051717},{\"x\":156.01701649046416,\"y\":355.05931058002744},{\"x\":162.0132427536615,\"y\":355.13151286950085},{\"x\":175.0484568237635,\"y\":358.8928334599702},{\"x\":179.01435902263174,\"y\":359.09624805683313},{\"x\":186.01319284263573,\"y\":359.13709651326474},{\"x\":191.0259633487298,\"y\":359.9911836908747},{\"x\":197.01339422166464,\"y\":360.122600149853},{\"x\":204.01318032645906,\"y\":360.140099291822},{\"x\":211.01317755057724,\"y\":360.14209291951863},{\"x\":224.01317751422926,\"y\":360.1423326466694},{\"x\":232.0131775140778,\"y\":360.1423475648669},{\"x\":245.01317751407623,\"y\":360.14234913449735},{\"x\":257.01317751407623,\"y\":360.1423492355827},{\"x\":274.01317751407623,\"y\":360.14234924278287},{\"x\":292.01317751407623,\"y\":360.14234924314593},{\"x\":311.01317751407623,\"y\":360.14234924316327},{\"x\":345.01317751407623,\"y\":360.14234924316406},{\"x\":356.01317751407623,\"y\":360.14234924316406},{\"x\":368.01317751407623,\"y\":360.14234924316406},{\"x\":382.01317751407623,\"y\":360.14234924316406},{\"x\":397.01317751407623,\"y\":360.14234924316406},{\"x\":409.01317751407623,\"y\":360.14234924316406},{\"x\":426.01317751407623,\"y\":360.14234924316406},{\"x\":437.01317751407623,\"y\":360.14234924316406},{\"x\":454.01317751407623,\"y\":360.14234924316406},{\"x\":470.01317751407623,\"y\":360.14234924316406},{\"x\":487.01317751407623,\"y\":360.14234924316406},{\"x\":501.01317751407623,\"y\":360.14234924316406},{\"x\":518.0131775140762,\"y\":360.14234924316406},{\"x\":530.0131775140762,\"y\":360.14234924316406},{\"x\":541.0131775140762,\"y\":360.14234924316406},{\"x\":551.0131775140762,\"y\":360.14234924316406},{\"x\":561.0131775140762,\"y\":360.14234924316406},{\"x\":572.0131775140762,\"y\":360.14234924316406},{\"x\":582.0131775140762,\"y\":360.14234924316406},{\"x\":590.0131775140762,\"y\":360.14234924316406},{\"x\":599.0131775140762,\"y\":360.14234924316406},{\"x\":609.0131775140762,\"y\":360.14234924316406},{\"x\":617.0131775140762,\"y\":360.14234924316406},{\"x\":624.0131775140762,\"y\":360.14234924316406},{\"x\":637.0131775140762,\"y\":360.14234924316406},{\"x\":641.0131775140762,\"y\":360.14234924316406},{\"x\":651.0131775140762,\"y\":360.14234924316406},{\"x\":658.0131775140762,\"y\":360.14234924316406},{\"x\":668.0131775140762,\"y\":360.14234924316406},{\"x\":680.0131775140762,\"y\":360.14234924316406},{\"x\":689.0131775140762,\"y\":360.14234924316406},{\"x\":699.0131775140762,\"y\":360.14234924316406},{\"x\":709.0131775140762,\"y\":360.14234924316406},{\"x\":718.0131775140762,\"y\":360.14234924316406},{\"x\":728.0131775140762,\"y\":360.14234924316406},{\"x\":736.0131775140762,\"y\":360.14234924316406},{\"x\":739.0131775140762,\"y\":360.14234924316406},{\"x\":742.0131775140762,\"y\":360.14234924316406},{\"x\":744.0131775140762,\"y\":360.14234924316406},{\"x\":745.0131775140762,\"y\":360.14234924316406},{\"x\":747.0131775140762,\"y\":360.14234924316406},{\"x\":748.0131775140762,\"y\":360.14234924316406},{\"x\":751.0131775140762,\"y\":360.14234924316406},{\"x\":756.0131775140762,\"y\":360.14234924316406},{\"x\":762.0131775140762,\"y\":360.14234924316406},{\"x\":777.0202140942455,\"y\":358.25467168307955},{\"x\":791.0220957279953,\"y\":356.26873456703345},{\"x\":810.0131956807677,\"y\":356.1480676095066},{\"x\":829.0131775512341,\"y\":356.14260786296626},{\"x\":844.0131775141953,\"y\":356.14236388202045},{\"x\":854.013177514077,\"y\":356.14235045187695},{\"x\":866.0131775140762,\"y\":356.14234932749287},{\"x\":871.0131775140762,\"y\":356.1423492560278},{\"x\":874.0131775140762,\"y\":356.1423492461326},{\"x\":879.0131775140762,\"y\":356.1423492436169},{\"x\":880.0131775140762,\"y\":356.14234924337853},{\"x\":880.3111092566066,\"y\":355.8113139650598},{\"x\":880.8624696028912,\"y\":346.0409195894619},{\"x\":880.9085670771143,\"y\":337.042337410406},{\"x\":880.9127968135526,\"y\":327.042349138814},{\"x\":880.9131544963413,\"y\":313.0423492190285},{\"x\":880.9131763341169,\"y\":296.04234921932147},{\"x\":880.9131774204018,\"y\":282.0423492193222},{\"x\":880.9131774865155,\"y\":266.0423492193222},{\"x\":880.9131774900363,\"y\":250.0423492193222},{\"x\":880.9131774902244,\"y\":233.0423492193222},{\"x\":880.9131774902337,\"y\":221.0423492193222},{\"x\":880.9131774902344,\"y\":206.0423492193222},{\"x\":879.0510650088275,\"y\":194.03172373644622},{\"x\":877.9703082377029,\"y\":177.04053409873575},{\"x\":876.0219376560314,\"y\":161.0357535096753},{\"x\":875.9186477929817,\"y\":144.0423325946059},{\"x\":873.0622046029779,\"y\":127.02992508598089},{\"x\":870.0692188616724,\"y\":110.0287188317017},{\"x\":867.9908583969186,\"y\":86.03899055038863},{\"x\":863.0930304274581,\"y\":62.0241955325233},{\"x\":860.0426053211138,\"y\":41.03299417447985},{\"x\":858.008981118338,\"y\":22.037235616915964},{\"x\":857.9179957397371,\"y\":5.042336321713744},{\"x\":857.9133954011452,\"y\":-13.957650807058446}],\"brushColor\":\"red\",\"brushRadius\":43},{\"points\":[{\"x\":65.9499670563273,\"y\":39.2431015103833},{\"x\":65.9499670563273,\"y\":39.2431015103833},{\"x\":65.93060775901907,\"y\":40.24251806854587},{\"x\":67.26336659493145,\"y\":41.51965689743442},{\"x\":70.27441277777339,\"y\":44.50833063208132},{\"x\":72.03808278480687,\"y\":44.93208937153513},{\"x\":76.03969151538504,\"y\":45.925503194488556},{\"x\":81.01379025933568,\"y\":46.10914433417395},{\"x\":90.07969795477634,\"y\":49.80277330017441},{\"x\":107.01334062989406,\"y\":50.12521501258504},{\"x\":126.01317784768884,\"y\":50.141574322168246},{\"x\":147.01317751463966,\"y\":50.142317397096086},{\"x\":171.01317751407697,\"y\":50.14234809210139},{\"x\":192.01317751407623,\"y\":50.14234919586012},{\"x\":211.01317751407623,\"y\":50.14234924102469},{\"x\":222.01317751407623,\"y\":50.14234924300226},{\"x\":230.01317751407623,\"y\":50.1423492431477},{\"x\":232.01317751407623,\"y\":50.14234924315898},{\"x\":234.01317751407623,\"y\":50.142349243162485},{\"x\":236.01317751407623,\"y\":50.14234924316357},{\"x\":241.01317751407623,\"y\":50.142349243163984},{\"x\":248.01317751407623,\"y\":50.142349243164055},{\"x\":265.01317751407623,\"y\":50.14234924316406},{\"x\":286.01411431170925,\"y\":49.18340235638342},{\"x\":310.0310745972162,\"y\":44.3209393974661},{\"x\":331.01320748690415,\"y\":44.14969432249888},{\"x\":355.01391310895633,\"y\":43.17872959018377},{\"x\":385.0151256628314,\"y\":41.201534312082295},{\"x\":408.01650003825506,\"y\":39.2196118097568},{\"x\":434.0131812272973,\"y\":39.144934544687736},{\"x\":452.0131775224962,\"y\":39.14247235278036},{\"x\":465.01317751411153,\"y\":39.14235721429011},{\"x\":481.05015635831785,\"y\":34.397681346414316},{\"x\":491.013426023117,\"y\":34.16349763565191},{\"x\":504.0131785557996,\"y\":34.14371858640369},{\"x\":512.0131775247289,\"y\":34.14248771608721},{\"x\":522.0131775141489,\"y\":34.14236067670791},{\"x\":549.0131775140763,\"y\":34.142349611988045},{\"x\":565.0131775140762,\"y\":34.142349262805574},{\"x\":579.0131775140762,\"y\":34.14234924435046},{\"x\":594.0131775140762,\"y\":34.142349243231216},{\"x\":606.0131775140762,\"y\":34.142349243168745},{\"x\":618.0131775140762,\"y\":34.14234924316439},{\"x\":632.015197627907,\"y\":35.08208213821346},{\"x\":645.0342334936161,\"y\":37.948810079444584},{\"x\":656.0132969426102,\"y\":38.127687828085065},{\"x\":671.0150045330669,\"y\":39.08503174062211},{\"x\":688.0354473383562,\"y\":42.94337754274265},{\"x\":702.0132579895454,\"y\":43.130313905013246},{\"x\":717.0131777719096,\"y\":43.141667994372504},{\"x\":736.0131775146036,\"y\":43.142318432917605},{\"x\":747.0131775140793,\"y\":43.14234691297741},{\"x\":755.0131775140762,\"y\":43.142349007527216},{\"x\":761.0131775140762,\"y\":43.14234921242882},{\"x\":767.0131775140762,\"y\":43.142349239155116},{\"x\":771.0313538610053,\"y\":43.96238523560182},{\"x\":775.0137884241364,\"y\":44.10919407964616},{\"x\":780.026669545415,\"y\":44.98709583464533},{\"x\":785.0134903760766,\"y\":45.118620490500724},{\"x\":787.013207646789,\"y\":45.134984599677075},{\"x\":791.0131785306254,\"y\":45.14099654678267},{\"x\":801.0131775210067,\"y\":45.14223755263031},{\"x\":810.0131775141335,\"y\":45.142339089479414},{\"x\":815.0131775140776,\"y\":45.142347694296944},{\"x\":822.0131775140762,\"y\":45.14234906671085},{\"x\":829.0131775140762,\"y\":45.1423492230618},{\"x\":837.0131775140762,\"y\":45.14234924113125},{\"x\":851.0131775140762,\"y\":45.142349243041274},{\"x\":868.0131775140762,\"y\":45.14234924315789},{\"x\":882.0131775140762,\"y\":45.142349243163686},{\"x\":886.0131775140762,\"y\":45.14234924316399},{\"x\":887.0131775140762,\"y\":45.14234924316403},{\"x\":887.0131775140762,\"y\":45.14234924316403}],\"brushColor\":\"red\",\"brushRadius\":43},{\"points\":[{\"x\":60.46960830170701,\"y\":65.84972800247802},{\"x\":60.46960830170701,\"y\":65.84972800247802},{\"x\":59.418689648767895,\"y\":67.39773027036023},{\"x\":58.99207037912427,\"y\":72.24581376189896},{\"x\":58.92521799163632,\"y\":77.24242981154218},{\"x\":58.91454920528566,\"y\":84.2423503123411},{\"x\":58.913333761583985,\"y\":91.242349280573},{\"x\":57.99541373326127,\"y\":101.24611425309868},{\"x\":57.92149667861524,\"y\":109.24238771721457},{\"x\":57.91386439790335,\"y\":119.2423495291405},{\"x\":57.91326708688775,\"y\":125.24234927146567},{\"x\":57.913182561742936,\"y\":140.24234926702022},{\"x\":57.913178003083544,\"y\":148.24234926700606},{\"x\":57.91317754866022,\"y\":155.24234926700592},{\"x\":57.91317749914679,\"y\":160.24234926700592},{\"x\":57.91317749159389,\"y\":165.24234926700592},{\"x\":57.913177490411705,\"y\":171.24234926700592},{\"x\":57.9131774902575,\"y\":177.24234926700592},{\"x\":57.913177490237395,\"y\":183.24234926700592},{\"x\":57.91317749023458,\"y\":195.24234926700592},{\"x\":56.07560352000105,\"y\":205.25712738287203},{\"x\":52.171611687459276,\"y\":218.28025196165265},{\"x\":50.98911241803582,\"y\":232.24555838470016},{\"x\":48.01933032810862,\"y\":257.24863142858504},{\"x\":43.126837868395356,\"y\":277.2680785757568},{\"x\":42.09527706309138,\"y\":282.26096413854185},{\"x\":41.93698552528693,\"y\":288.2426642235313},{\"x\":41.91867199339557,\"y\":291.2423660391432},{\"x\":41.09409105415445,\"y\":295.26071993360455},{\"x\":40.95507887514576,\"y\":298.24332519953276},{\"x\":40.926184387175574,\"y\":300.2424432604544},{\"x\":40.917214203582056,\"y\":302.2423583198598},{\"x\":40.333674130354744,\"y\":303.3466215681821},{\"x\":38.26001617731499,\"y\":308.3118657200109},{\"x\":37.446558893164315,\"y\":309.4174325334014},{\"x\":37.08606457964834,\"y\":311.2591108770371},{\"x\":36.388969157305894,\"y\":312.3783975126012},{\"x\":36.147558513734104,\"y\":313.2734041971986},{\"x\":35.409180991989004,\"y\":314.3913629028543},{\"x\":35.409180991989004,\"y\":314.3913629028543}],\"brushColor\":\"red\",\"brushRadius\":43},{\"points\":[{\"x\":148.8063495727419,\"y\":162.03169849479883},{\"x\":148.8063495727419,\"y\":162.03169849479883},{\"x\":147.68945171146163,\"y\":162.68693921852397},{\"x\":147.33673048419396,\"y\":163.3482442007468},{\"x\":147.04806575803764,\"y\":165.25251492583658},{\"x\":146.9551409359506,\"y\":167.24332809418686},{\"x\":147.50780176128956,\"y\":168.33881301158075},{\"x\":152.0229599197193,\"y\":169.0100139333223},{\"x\":156.013506872797,\"y\":169.118003048297},{\"x\":160.01318862455764,\"y\":169.13787724779687},{\"x\":169.01769369703246,\"y\":168.23239774785662},{\"x\":181.01319945598226,\"y\":168.14863374381096},{\"x\":189.06050827638782,\"y\":165.43036863286372},{\"x\":199.01349429096126,\"y\":165.16622596886828},{\"x\":206.0206430069746,\"y\":164.25803050040514},{\"x\":215.0547471171906,\"y\":161.41271427736888},{\"x\":216.02255298778766,\"y\":161.27191757543},{\"x\":219.0136761809749,\"y\":161.17230507273294},{\"x\":219.0136761809749,\"y\":161.17230507273294}],\"brushColor\":\"red\",\"brushRadius\":5},{\"points\":[{\"x\":139.64955361886663,\"y\":184.28182474523868},{\"x\":139.64955361886663,\"y\":184.28182474523868},{\"x\":140.16928881176108,\"y\":184.6357630302408},{\"x\":142.02813482682313,\"y\":184.97894960722022},{\"x\":144.01461752869346,\"y\":185.09145766625548},{\"x\":145.01350067714256,\"y\":185.11823308531083},{\"x\":147.0132086389083,\"y\":185.13486434319742},{\"x\":149.01318051182798,\"y\":185.14002632602288},{\"x\":155.01317756507763,\"y\":185.14204625386424},{\"x\":162.01317751473817,\"y\":185.14231472539635},{\"x\":172.01694107288148,\"y\":184.22456992970416},{\"x\":186.01319122326208,\"y\":184.14731677232203},{\"x\":200.0131775640937,\"y\":184.14264929551277},{\"x\":215.01317751423647,\"y\":184.1423662272589},{\"x\":222.0131775140783,\"y\":184.1423511780609},{\"x\":229.01317751407626,\"y\":184.14234946359534},{\"x\":231.01317751407623,\"y\":184.14234931157375},{\"x\":236.01317751407623,\"y\":184.14234925359943},{\"x\":237.01317751407623,\"y\":184.14234924810714},{\"x\":237.01317751407623,\"y\":184.14234924810714}],\"brushColor\":\"red\",\"brushRadius\":5},{\"points\":[{\"x\":337.7964318981234,\"y\":172.31515435891387},{\"x\":337.7964318981234,\"y\":172.31515435891387},{\"x\":339.0161616881952,\"y\":172.21557907299268},{\"x\":347.013207998484,\"y\":172.1497567395874},{\"x\":354.01317790971996,\"y\":172.14319313802727},{\"x\":361.0131775192112,\"y\":172.1424453830872},{\"x\":365.0131775142495,\"y\":172.14236690151694},{\"x\":372.0131775140785,\"y\":172.1423512548751},{\"x\":384.01317751407623,\"y\":172.142349383516},{\"x\":410.01317751407623,\"y\":172.14234924785984},{\"x\":425.0149522436199,\"y\":173.0858570894695},{\"x\":441.01976914306016,\"y\":175.03362260298763},{\"x\":451.01780319471726,\"y\":176.05121841406716},{\"x\":459.0630440670106,\"y\":178.84692900045465},{\"x\":467.022666575308,\"y\":180.0120025229076},{\"x\":471.01349701560645,\"y\":180.11837007182868},{\"x\":472.01324920560336,\"y\":180.13098968306176},{\"x\":472.01324920560336,\"y\":180.13098968306176}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":329.13403029587516,\"y\":185.69187215539287},{\"x\":329.13403029587516,\"y\":185.69187215539287},{\"x\":330.04070978586714,\"y\":185.92144188266917},{\"x\":331.01937619572703,\"y\":186.03690161150877},{\"x\":335.01338636783964,\"y\":186.12296127926217},{\"x\":338.01318863616007,\"y\":186.13787491341992},{\"x\":341.0131781063757,\"y\":186.14131670328675},{\"x\":352.01317751746416,\"y\":186.14227115191116},{\"x\":365.01317751409044,\"y\":186.14234418689603},{\"x\":411.01317751407623,\"y\":186.14234914613547},{\"x\":432.01317751407623,\"y\":186.14234923917658},{\"x\":456.01317751407623,\"y\":186.14234924301994},{\"x\":472.01317751407623,\"y\":186.1423492431564},{\"x\":487.01317751407623,\"y\":186.14234924316364},{\"x\":492.01317751407623,\"y\":186.142349243164},{\"x\":494.01317751407623,\"y\":186.14234924316403},{\"x\":494.01317751407623,\"y\":186.14234924316403}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":590.0493037066256,\"y\":149.2527034651739},{\"x\":590.0493037066256,\"y\":149.2527034651739},{\"x\":589.9446555836961,\"y\":152.24289991901253},{\"x\":591.6283069857335,\"y\":157.2886228509575},{\"x\":594.4087444943913,\"y\":161.39699878211275},{\"x\":595.5777166016057,\"y\":164.3072049746181},{\"x\":599.2390751131039,\"y\":167.54603896970593},{\"x\":600.2618279262301,\"y\":168.52126655739983},{\"x\":607.1427818858742,\"y\":172.67706377179493},{\"x\":609.1176028465746,\"y\":173.7215631413851},{\"x\":611.0232026240454,\"y\":174.00839143399799},{\"x\":617.0133475693856,\"y\":174.12485436877628},{\"x\":618.0132156713285,\"y\":174.1340618071137},{\"x\":624.0131781632472,\"y\":174.14126826807123},{\"x\":630.087767197486,\"y\":171.50109400718105},{\"x\":642.1861565218129,\"y\":162.67285887414187},{\"x\":651.236526550196,\"y\":154.73576601275334},{\"x\":660.1694191128068,\"y\":148.64912674176773},{\"x\":668.2303147731735,\"y\":141.72860726377692},{\"x\":672.3349994239577,\"y\":136.83206663511612},{\"x\":674.2903956662095,\"y\":134.79207438254915},{\"x\":674.7072560602395,\"y\":133.01847498856452},{\"x\":674.8149842124168,\"y\":132.03697656069696},{\"x\":674.8149842124168,\"y\":132.03697656069696}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":709.2150630914297,\"y\":169.71036002058491},{\"x\":709.2150630914297,\"y\":169.71036002058491},{\"x\":714.2109681928871,\"y\":165.70528979047225},{\"x\":718.0195586156391,\"y\":165.24933178403765},{\"x\":724.0524820020539,\"y\":163.40541431821308},{\"x\":726.0898571238349,\"y\":162.5058647605172},{\"x\":729.0172181030126,\"y\":162.2275357064894},{\"x\":732.0461823710128,\"y\":161.38384338456456},{\"x\":736.0142833809579,\"y\":161.18695123182692},{\"x\":737.1246200607414,\"y\":160.57614313140618},{\"x\":738.0385352886066,\"y\":160.35448357847156},{\"x\":740.1999203853707,\"y\":158.69122469301226},{\"x\":746.1175135893318,\"y\":155.56296654414572},{\"x\":751.082701472883,\"y\":153.48920590187024},{\"x\":761.1061652379595,\"y\":148.5407600635029},{\"x\":770.1247378462662,\"y\":143.57635717500844},{\"x\":776.1100846685832,\"y\":140.54860270702267},{\"x\":782.2085693271719,\"y\":135.70228432299956},{\"x\":786.2669223724813,\"y\":131.76873113934454},{\"x\":790.3401033855727,\"y\":126.83631323909673},{\"x\":792.1614567167342,\"y\":125.63723896398362},{\"x\":792.1614567167342,\"y\":125.63723896398362}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":550.9605746934046,\"y\":254.24359818629887},{\"x\":550.9605746934046,\"y\":254.24359818629887},{\"x\":550.9241180014924,\"y\":257.2424157665681},{\"x\":556.1589838859852,\"y\":260.65123625779887},{\"x\":562.1637344841587,\"y\":264.6440168864694},{\"x\":567.0422656712522,\"y\":265.91538545609285},{\"x\":575.0673994988522,\"y\":268.83468132742036},{\"x\":584.036924093456,\"y\":270.9369716842168},{\"x\":591.0465106556417,\"y\":272.8996796016723},{\"x\":594.0149447286029,\"y\":273.08597670537745},{\"x\":596.1791687508762,\"y\":274.62155069513375},{\"x\":601.0168669369218,\"y\":275.060940711024},{\"x\":604.0133738966992,\"y\":275.12354897332887},{\"x\":607.0131879720519,\"y\":275.13801055138515},{\"x\":612.013177757424,\"y\":275.1416874078456},{\"x\":615.0131775270356,\"y\":275.1421965119325},{\"x\":620.0131775143777,\"y\":275.14232594518006},{\"x\":628.0350754490039,\"y\":273.3396732464469},{\"x\":640.1275475387519,\"y\":266.58142274090466},{\"x\":650.0557117444994,\"y\":263.4157581895717},{\"x\":661.0908352768554,\"y\":258.508072145345},{\"x\":665.1751564884714,\"y\":255.65744628066432},{\"x\":665.1751564884714,\"y\":255.65744628066432}],\"brushColor\":\"red\",\"brushRadius\":1},{\"points\":[{\"x\":324.099008704239,\"y\":215.52592341460348},{\"x\":324.099008704239,\"y\":215.52592341460348},{\"x\":326.1055121685007,\"y\":214.53943447979913},{\"x\":327.03413619565475,\"y\":214.3354460051993},{\"x\":330.01429054558326,\"y\":214.1870953918298},{\"x\":336.01319644413957,\"y\":214.14818651604708},{\"x\":345.01317767052194,\"y\":214.1428799052449},{\"x\":364.0131775143962,\"y\":214.14237324295624},{\"x\":385.0131775140768,\"y\":214.14235022945687},{\"x\":417.01317751407623,\"y\":214.1423492701447},{\"x\":456.01317751407623,\"y\":214.14234924377266},{\"x\":504.01317751407623,\"y\":214.14234924317526},{\"x\":542.0131775140762,\"y\":214.14234924316432},{\"x\":569.0131775140762,\"y\":214.14234924316406},{\"x\":582.0131775140762,\"y\":214.14234924316406},{\"x\":582.0131775140762,\"y\":214.14234924316406}],\"brushColor\":\"red\",\"brushRadius\":1}],\"width\":900,\"height\":400}";
        jsonObject.put("correct",correct);
        jsonObject.put("id","5fc72f9eb2869f4368cd3366");

        MvcResult authResult = mockMvc.perform(post("/editStudentHomework")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .content(jsonObject.toString())//请求的参数（可多个）
        ).andExpect(status().isOk()).andReturn();
        StudentHomework homework = studentHomeworkRepository.findByStudentIdAndHomeworkId("student",1);
        assertNotNull(homework);

    }

    @Test
    public void initBinder() {
    }

    @Test
    public void getHomeworkOfStudents() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/getHomeworkOfStudents")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("homeworkId", "1")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        JSONArray jsonArray = JSONArray.parseArray(result);
        System.out.println(jsonArray.getJSONObject(0));
        for (int i = 0 ; i < jsonArray.size(); ++i){
            JSONObject jsonObject = jsonArray.getJSONObject(i);
            assertNotNull(jsonObject);
        }

    }

    @Test
    public void getPageHomeworkOfStudents() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/getPageHomeworkOfStudents")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("homeworkId", "1")
                .param("page", "1")
                .param("size", "1")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        JSONArray jsonArray = JSONArray.parseArray(result);
        System.out.println(jsonArray.getJSONObject(0));
        for (int i = 0 ; i < jsonArray.size(); ++i){
            JSONObject jsonObject = jsonArray.getJSONObject(i);
            assertNotNull(jsonObject);
        }
    }

    @Test
    public void getHomeworkOfStudentsNoMongo() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/getHomeworkOfStudents")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("homeworkId", "1")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        JSONArray jsonArray = JSONArray.parseArray(result);
        System.out.println(jsonArray.getJSONObject(0));
        for (int i = 0 ; i < jsonArray.size(); ++i){
            JSONObject jsonObject = jsonArray.getJSONObject(i);
            assertNotNull(jsonObject);
        }
    }

    @Test
    public void editStudentHomework() throws Exception {
        JSONObject jsonObject = new JSONObject();
        jsonObject.put("homeworkId","1");
        jsonObject.put("courseId","1");
        jsonObject.put("studentId","student");
        jsonObject.put("title","数学第二次迭代");
        jsonObject.put("startTime","1970-10-10 11:11:11");
        jsonObject.put("endTime","1970-10-10 11:11:11");
        jsonObject.put("score","100");
        jsonObject.put("nickname","student");
        jsonObject.put("subject","一年级上数学");
        jsonObject.put("content","第一次迭代");
        jsonObject.put("comment","做得很好");
        jsonObject.put("remarks","第一次迭代做完了");
        jsonObject.put("finishHomework","1");
        jsonObject.put("handinRank","1");
        jsonObject.put("upload","/homework/student/1605603006322WechatIMG859.jpeg");
        jsonObject.put("ocontent",null);
        jsonObject.put("id","5fc72f9eb2869f4368cd3366");

        MvcResult authResult = mockMvc.perform(post("/editStudentHomework")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .content(jsonObject.toString())//请求的参数（可多个）
        ).andExpect(status().isOk()).andReturn();
        StudentHomework homework = studentHomeworkRepository.findByStudentIdAndHomeworkId("student",1);
        assertNotNull(homework);
    }

    @Test
    public void editStudentHomeworkByTeacher() throws Exception {
        JSONObject jsonObject = new JSONObject();
        jsonObject.put("homeworkId","1");
        jsonObject.put("courseId","1");
        jsonObject.put("studentId","student");
        jsonObject.put("title","数学第二次迭代");
        jsonObject.put("startTime","1970-10-10 11:11:11");
        jsonObject.put("endTime","1970-10-10 11:11:11");
        jsonObject.put("score","100");
        jsonObject.put("nickname","student");
        jsonObject.put("subject","一年级上数学");
        MvcResult authResult = mockMvc.perform(post("/editStudentHomeworkByTeacher")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .content(jsonObject.toString())//请求的参数（可多个）
        ).andExpect(status().isOk()).andReturn();
        StudentHomework homework = studentHomeworkRepository.findByStudentIdAndHomeworkId("student",1);
        assertNotNull(homework);
    }

    @Test
    public void addStudentHomework() throws Exception {
        JSONObject jsonObject = new JSONObject();
        jsonObject.put("homeworkId","5");
        jsonObject.put("courseId","1");
        jsonObject.put("studentId","student");
        jsonObject.put("title","数学第二次迭代");
        jsonObject.put("startTime","1970-10-10 11:11:11");
        jsonObject.put("endTime","1970-10-10 11:11:11");
        jsonObject.put("score","100");
        jsonObject.put("nickname","student");
        jsonObject.put("subject","一年级上数学");

        MvcResult authResult = mockMvc.perform(post("/addStudentHomework")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .content(jsonObject.toString())//请求的参数（可多个）
        ).andExpect(status().isOk()).andReturn();
        List<StudentHomework> homeworkList = studentHomeworkRepository.findAll();
        Assert.assertTrue(homeworkList.size()>=2);
    }

    @Test
    public void deleteStudentHomeworkAll() throws Exception {
        MvcResult authResult = mockMvc.perform(post("/deleteStudentHomeworkAll")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("courseId", "1")
                .param("studentId","student")//请求的参数（可多个）
        ).andExpect(status().isOk()).andReturn();
        List<StudentHomework> homeworkList = studentHomeworkRepository.findByStudentIdAndCourseId("student", 1);
        Assert.assertEquals(homeworkList.size(),0);
    }

    @Test
    public void deleteStudentHomeworkOne() throws Exception {
        MvcResult authResult = mockMvc.perform(post("/deleteStudentHomeworkOne")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("homeworkId", "1")
                .param("studentId","student")//请求的参数（可多个）
        ).andExpect(status().isOk()).andReturn();
        StudentHomework homework = studentHomeworkRepository.findByStudentIdAndHomeworkId("student", 1);
        Assert.assertNull(homework);
    }

    @Test
    public void getStudentStatistics() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/getStudentStatistics")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("studentId", "student")
                .param("courseId", "1")
                .param("times", "1")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        JSONObject jsonObject = JSONObject.parseObject(result);
        assertNotNull(jsonObject);
    }

    @Test
    public void getAverage() throws Exception {
        MvcResult authResult;
        authResult = mockMvc.perform(get("/getAverage")//使用get方式来调用接口。
                .contentType(MediaType.APPLICATION_JSON_VALUE)//请求参数的类型
                .param("homeworkId", "4")
        ).andExpect(status().isOk())
                .andReturn();
        String result = authResult.getResponse().getContentAsString();
        assertNotNull(result);
    }
}
